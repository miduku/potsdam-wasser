/*!
 * fastplate
 * Barebones Responsive SCSS Boilerplate with vertical rhythm
 * http://miduku.github.io/fastplate/example.html
 * @author Dustin Kummer
 * @version 0.0.1
 * Copyright 2016. MIT licensed.
 */
!function(e,t){"use strict";var r=function(){function t(e){var t,r,a=e.offsetHeight;if(n)o=n();else for(var s in i)t=s,document.body.clientWidth>t&&t>=r&&(o=i[s],r=t);e.style.marginBottom=o-a%o+"px"}function r(r){t(r),"addEventListener"in e?e.addEventListener("resize",function(){t(r)},!1):"attachEvent"in e&&e.attachEvent("resize",function(){t(r)})}var n,o=0,i={};return function(e,t){var a="string"==typeof e?document.querySelectorAll(e):e,s=a.length;if("number"==typeof t)o=parseInt(t,10);else if("function"==typeof t)n=t;else if("object"==typeof t){var l=parseInt(getComputedStyle(document.body,null).getPropertyValue("font-size"),10);for(var c in i){var d=/\d+em/.test(c)?parseInt(c,10)*l:/\d+px/.test(c)?parseInt(c,10):c;i[d]=parseInt(i[c],10)}}if(s>1)for(;s--;)r(a[s]);else r(a[0])}}();"undefined"!=typeof t?t.extend(t.fn,{baseline:function(e){return r(this,e)}}):e.baseline=r}(window,window.jQuery||window.Zepto||void 0),function(e,t,r,n){"use strict";function o(e){var t=e.parent().innerHeight(),r=e.innerHeight(),n=e.innerWidth();return e.css({position:"absolute",top:t/2-r/2,left:l.w.outerWidth()/2-n/2,paddingTop:0})}function i(e,t){return t.offset().top-e.offset().top}function a(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function s(e,t,r){var n=a(e,[0,0]),o=a(e,[t,0]),i=a(e,[t,r]),s=a(e,[0,r]);return Math.max(n,o,i,s)}var l={w:e(t),main:e(".main"),content:e(".content"),footer:e(".footer"),header_container:e(".header .container"),headerSticky:e(".header-sticky"),headerArticle:e(".header-article"),headerStream:e(".header-stream"),sectionReinigung_headerArticle:e(".section-reinigung .header-article"),sectionVersorgung_headerArticle:e(".section-versorgung .header-article"),fullscreen:e(".fullscreen"),baselineElements:e("picture > *, .group-img img, .embed, figure img, figure figcaption, .fullscreen, .header-article .l img"),anim:{rain:e(".anim-rain")}},c={offsetLeft:0,offsetTop:.8,width:10,colors:{gewinnung:[40,137,179],versorgung:[56,115,184],reinigung:[130,154,175]}};e(function(){l.w.scrollTop(0),l.headerArticle.append('<span class="circle"></span>'),e(t).trigger("resize"),l.content.append('<div class="stream"><span class="water"></span></div>').children(".stream").css({position:"absolute",left:100*c.offsetLeft+"%",width:c.width+"px",marginLeft:-(c.width/2)+"px"}),e('.nav-main a[href^="#"]').bind("click.smoothscroll",function(r){r.preventDefault();var n=this.hash,o=e(n);e("html, body").stop().animate({scrollTop:o.offset().top-64},900,"swing",function(){t.location.hash=n})}),l.baselineElements.baseline(function(){return parseFloat(getComputedStyle(r.documentElement,null).getPropertyValue("line-height"))});var n={Controller:new ScrollMagic.Controller,tween:{CloudFromRight:TweenMax.staggerFromTo(".cloudFromRight",2,{left:"100%"},{left:"0%",ease:Power1.easeInOut},1),CloudFromLeft:TweenMax.staggerFromTo(".cloudFromLeft",2,{right:"100%"},{right:"0%",ease:Power1.easeInOut},1)},scene:{CloudsFromRight:new ScrollMagic.Scene({triggerElement:".anim-rain",triggerHook:1,duration:l.anim.rain.innerHeight()/3}),CloudsFromLeft:new ScrollMagic.Scene({triggerElement:".anim-rain",triggerHook:1,duration:l.anim.rain.innerHeight()/3})},cast:{CloudsFromRight:function(){return n.scene.CloudsFromRight.addTo(n.Controller).setTween(n.tween.CloudFromRight).addIndicators({name:"staggering"})},CloudsFromLeft:function(){return n.scene.CloudsFromLeft.addTo(n.Controller).setTween(n.tween.CloudFromLeft).addIndicators({name:"staggering2"})},Flood:function(t){return t.each(function(t,r){new ScrollMagic.Scene({triggerElement:r,triggerHook:c.offsetTop,duration:e(r).outerHeight()}).addTo(n.Controller).addIndicators({name:"flood"+t}).on("progress end",function(t){"AFTER"===t.state?e(r).children(".circle").css({transform:"scale(1)"}):e(r).children(".circle").css({transform:"scale("+t.progress.toFixed(3)+")"})})})},Stream:function(t){var r=[l.sectionVersorgung_headerArticle,l.sectionReinigung_headerArticle,l.footer];return t.each(function(t,o){var a=i(e(o).parent(),r[t]),s=a-l.w.outerHeight(),d=[c.colors.gewinnung,c.colors.versorgung,c.colors.reinigung,c.colors.gewinnung],g=[d[t+1][0]-d[t][0],d[t+1][1]-d[t][1],d[t+1][2]-d[t][2]],u=new ScrollMagic.Scene({triggerElement:o,triggerHook:0,duration:s}).addTo(n.Controller).setPin(o).addIndicators({name:"Stream"+t}).on("progress",function(r){var n=r.progress.toFixed(3),i=[Math.round(d[t][0]+g[0]*n),Math.round(d[t][1]+g[1]*n),Math.round(d[t][2]+g[2]*n)];e(o).children(".water").css({backgroundColor:"rgb("+i.join(",")+")",height:100*n+"%"}),t<2&&l.headerStream.children().children().eq(t).children().css({background:"linear-gradient(to right, rgb("+d[t][0]+","+d[t][1]+","+d[t][2]+") 0%, rgb("+i.join(",")+") 100%)",width:100*n+"%"})});l.w.on("load resize",function(){e(o).css({maxHeight:a+"px"}),u.duration(i(e(o).parent(),r[t])-l.w.outerHeight()),u.refresh()})})}}};n.cast.CloudsFromRight(),n.cast.CloudsFromLeft(),n.cast.Flood(l.headerArticle),n.cast.Stream(e(".stream"))});var d={allow:!0,reallow:function(){d.allow=!0},delay:300};l.w.on("load resize",function(){var t=l.w.outerHeight();l.fullscreen.outerHeight(t),l.anim.rain.outerHeight(3*t),e(".stream").css({height:t+"px"}),o(l.header_container),l.headerArticle.each(function(){var t=e(this).innerWidth(),r=e(this).innerHeight(),n=[t*c.offsetLeft,0],o=s(n,t,r);e(this).children(".circle").css({transform:"scale(0)",padding:o,marginLeft:-o,marginTop:-o,left:100*c.offsetLeft+"%"})})}),l.w.on("load scroll",function(){if(d.allow){var e=l.w.scrollTop();l.headerSticky.toggleClass("sticking",e>l.header_container.position().top),d.allow=!1,setTimeout(d.reallow,d.delay)}})}(jQuery,window,document);