/*!
 * fastplate
 * Barebones Responsive SCSS Boilerplate with vertical rhythm
 * http://miduku.github.io/fastplate/example.html
 * @author Dustin Kummer
 * @version 0.0.1
 * Copyright 2017. MIT licensed.
 */
!function(n,i){"use strict";var e=function(){function i(n){var i,e,a=n.offsetHeight;if(t)o=t();else for(var s in r)i=s,document.body.clientWidth>i&&i>=e&&(o=r[s],e=i);n.style.marginBottom=o-a%o+"px"}function e(e){i(e),"addEventListener"in n?n.addEventListener("resize",function(){i(e)},!1):"attachEvent"in n&&n.attachEvent("resize",function(){i(e)})}var t,o=0,r={};return function(n,i){var a="string"==typeof n?document.querySelectorAll(n):n,s=a.length;if("number"==typeof i)o=parseInt(i,10);else if("function"==typeof i)t=i;else if("object"==typeof i){var c=parseInt(getComputedStyle(document.body,null).getPropertyValue("font-size"),10);for(var d in r){var l=/\d+em/.test(d)?parseInt(d,10)*c:/\d+px/.test(d)?parseInt(d,10):d;r[l]=parseInt(r[d],10)}}if(s>1)for(;s--;)e(a[s]);else e(a[0])}}();"undefined"!=typeof i?i.extend(i.fn,{baseline:function(n){return e(this,n)}}):n.baseline=e}(window,window.jQuery||window.Zepto||void 0),function(n,i,e,t){"use strict";function o(n,i){return i.offset().top-n.offset().top-n.outerHeight()}function r(n,i){return i.offset().top-n.offset().top}var a={win:n(i),bod:n("body"),navContainer:n(".nav-container"),wide:n("main .wide"),navMain:{_this:n(".nav-main"),a:n(".nav-main a"),icon:{_this:n(".nav-main ul i"),gewinnung:n(".nav-main-gewinnung i"),versorgung:n(".nav-main-versorgung i"),reinigung:n(".nav-main-reinigung i"),natur:n(".nav-main-natur i"),last:n(".nav-main-last i")}},section:{intro:n("#section-intro"),natur:n("#section-natur")},icon:{_this:n(".container .icon i"),gewinnung:n("#section-gewinnung .icon i"),versorgung:n("#section-versorgung .icon i"),reinigung:n("#section-reinigung .icon i"),natur:n("#section-natur .icon i")},footer:{_this:n("footer")}},s={iconPositionsArr:{mainIcons:[a.icon.natur,a.icon.gewinnung,a.icon.versorgung,a.icon.reinigung,a.footer._this],navIcons:[a.navMain.icon.natur,a.navMain.icon.gewinnung,a.navMain.icon.versorgung,a.navMain.icon.reinigung,a.navMain.icon.last]},colors:{gewinnung:[40,137,179],versorgung:[56,115,184],reinigung:[130,154,175],natur:[46,156,204]},offset:{fromTop:.75}};n(function(){a.icon._this.append('<div class="waterpipe"><div class="water"></div></div>'),a.navMain._this.children("ul").find("li:not(:last) i").append('<div class="waterpipeNav"><div class="water"></div></div>'),a.wide.prepend('<div class="flood"><div class="circle"></div></div>'),a.bod.prepend('<div class="click-overlay"></div>'),a.navMain._this.prepend('<div class="click-navOverlay"></div>'),n('.nav-main:not(.hidden) a[href^="#"]').bind("click.smoothscroll",function(e){e.preventDefault();var t=this.hash,o=n(t);n(".click-overlay").removeClass("visible"),n("html, body").stop().animate({scrollTop:o.offset().top},900,"swing",function(){i.location.hash=t,a.navMain._this.addClass("hidden")})}),a.navMain._this.children(".click-navOverlay").on("click",function(i){i.preventDefault();var e=n(this).parent();e.hasClass("hidden")&&(e.removeClass("hidden"),n(".click-overlay").addClass("visible"))}),n(".click-overlay").on("click",function(i){i.preventDefault(),n(this).removeClass("visible"),a.navMain._this.addClass("hidden")});var e={Controller:new ScrollMagic.Controller,scene:{NavSticky:new ScrollMagic.Scene({triggerElement:"#section-intro",triggerHook:0,duration:r(a.section.intro,a.section.natur)})},cast:{NavSticky:function(){return e.scene.NavSticky.addTo(e.Controller).addIndicators({name:"navSticky"}).on("progress resize",function(i){var e=i.progress;.5<=e&&e<1?(a.navMain._this.removeClass("retracted hidden").addClass("extended").css({left:0}),n(".click-overlay").removeClass("visible")):1===e?a.navMain._this.removeClass("retracted extended").addClass("hidden extended").css({left:0}):a.navMain._this.removeClass("extended hidden").addClass("retracted").css({left:a.navContainer.offset().left})})},Flood:function(i){return i.each(function(i,t){var o=n(t);new ScrollMagic.Scene({triggerElement:t,triggerHook:.6,duration:o.outerHeight()}).addTo(e.Controller).addIndicators({name:"flood"+i}).on("progress",function(n){var i=n.progress.toFixed(3);o.children(".flood").children(".circle").css({transform:"scale("+i+")"}),i>=.25?o.addClass("showText"):o.removeClass("showText")}).on("update leave",function(n){"leave"===n.type&&"FORWARD"===n.target.controller().info("scrollDirection")&&o.next(".container").css("opacity",1)})})},Waterpipe:function(i,t,r){var c=[s.colors.natur,s.colors.gewinnung,s.colors.versorgung,s.colors.reinigung,s.colors.natur];return i.each(function(i,r){var d=n(r),l=[c[i+1][0]-c[i][0],c[i+1][1]-c[i][1],c[i+1][2]-c[i][2]],v=new ScrollMagic.Scene({triggerElement:r,triggerHook:s.offset.fromTop}).addTo(e.Controller).addIndicators({name:"Waterpipe"+i}).on("progress",function(n){var e=n.progress.toFixed(3),t=100*e,o=t+"%",r=t*e+"%",s=[Math.round(c[i][0]+l[0]*e),Math.round(c[i][1]+l[1]*e),Math.round(c[i][2]+l[2]*e)],v="linear-gradient(to bottom, rgb("+c[i][0]+","+c[i][1]+","+c[i][2]+") 0%, rgb("+s.join(",")+") 100%)";d.children(".water").css({background:v,height:r}),a.navMain.icon._this.eq(i).children(".waterpipeNav").children(".water").css({background:v,height:o})});a.win.on("resize",function(){v.duration(o(t[i],t[i+1])),v.refresh()})})}}};e.cast.Waterpipe(n(".waterpipe"),s.iconPositionsArr.mainIcons,"exponential"),e.cast.Flood(a.wide),e.cast.NavSticky(),a.win.trigger("resize"),a.navMain._this.trigger("resize")}),a.win.on("resize",function(){a.section.intro.css("height",a.win.outerHeight()),a.section.natur.css({height:2*a.win.outerHeight(),marginBottom:a.win.outerHeight()}),n(".waterpipe").each(function(i,e){n(e).css("height",o(s.iconPositionsArr.mainIcons[i],s.iconPositionsArr.mainIcons[i+1]))}),a.navMain.icon._this.each(function(i,e){i<s.iconPositionsArr.navIcons.length-1&&n(e).children(".waterpipeNav").css("height",o(s.iconPositionsArr.navIcons[i],s.iconPositionsArr.navIcons[i+1]))}),a.wide.each(function(i,e){var t=n(e),o={_this:t.find(".icon i"),size:t.find(".icon i").outerWidth()},r={posTop:o._this.position().top,posLeft:o._this.offset().left,size:t.outerWidth()};t.children(".flood").children(".circle").css({left:r.posLeft+o.size/2-r.size,top:r.posTop+o.size/2-r.size,width:2*r.size,height:2*r.size})})})}(jQuery,window,document);