/*!
 * potsdam-wasser
 * 
 * 
 * @author Dustin Kummer
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,i,r,n){"use strict";e(function(){function r(i,r,o,s){return new ScrollMagic.Scene({triggerElement:i,triggerHook:1,duration:e(i).outerHeight()}).addIndicators({name:i}).on("progress",function(i){e(r).css("height",100/3*i.progress.toFixed(3)+"%"),s===n&&(s=o);var t=[s[0]-o[0],s[1]-o[1],s[2]-o[2]],a=[Math.round(o[0]+t[0]*i.progress.toFixed(3)),Math.round(o[1]+t[1]*i.progress.toFixed(3)),Math.round(o[2]+t[2]*i.progress.toFixed(3))];e(".indicator").css("background-color","rgb("+a.join(",")+")")})}function o(r,o,s,t){null!==o&&o!==n||(o=1/e(i).height()*e(".header").outerHeight());var a,g=e(r).attr("data-set-pin");return a=null===s||s===n?e(r).outerHeight()-e(g).outerHeight()-20:s,t=null!==t&&t!==n,new ScrollMagic.Scene({triggerElement:r,triggerHook:o,duration:a,pushFollowers:t,reverse:!0}).addIndicators({name:r}).setPin(e(r).attr("data-set-pin"))}var s=e(".logo-pw"),t=e(".logo-pw, .sidebar"),a=e(".sidebar");e(i).on("scroll",function(){var r=e(i).scrollTop();e(".header").toggleClass("shrink",r>200),a.toggleClass("shrink",r>200)}),s.on("click",function(e){e.preventDefault(),a.hasClass("open")?t.removeClass("open"):t.addClass("open")}),e("main, footer").on("click",function(){a.hasClass("open")&&t.removeClass("open")});var g=new ScrollMagic.Controller({loglevel:3}),l=r(".sec-gewinnung",".indicator-gewinnung",[114,120,141]),c=r(".sec-verbrauch",".indicator-verbrauch",[114,120,141],[56,115,185]),d=r(".sec-reinigung",".indicator-reinigung",[56,115,185],[134,120,109]),u=new ScrollMagic.Scene({triggerElement:".progress-wrapper",triggerHook:0,duration:e(".progress-wrapper").outerHeight()-e(i).height(),reverse:!0}).addIndicators({name:"Progressbar"}).setPin(".progressbar");e("section").each(function(i,r){var n=e(this).outerHeight();new ScrollMagic.Scene({triggerElement:r,duration:n}).on("enter",function(){0===i&&e(".side-intro").addClass("active").siblings("li").removeClass("active").children("ul").slideUp(),1===i?e(".side-gewinnung > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp():2===i?e(".side-verbrauch > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp():3===i&&e(".side-reinigung > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp()}).addTo(g)}),e(".sec-intro").css("min-height",3*e(i).height()-e(".header").outerHeight()).children().children().children(".content").css({position:"absolute",top:100/3+"%",left:0}),e(i).on("load",function(){e(".progressbar, .scrollmagic-pin-spacer").css({height:e(i).outerHeight()+2}),e(".progressbar").append('<div class="indicator indicator-gewinnung"></div><div class="indicator indicator-verbrauch"></div><div class="indicator indicator-reinigung"></div>'),u.duration(e(".progress-wrapper").outerHeight()-e(i).height());var r=o("#trigger-reinigung-lageplan"),n=o("#trigger-reinigung-mechanische-reinigung"),s=o("#trigger-reinigung-biologische-reinigung");g.addScene([l,c,d,r,n,s,u]),e(".loader").animate({opacity:0},500,function(){e(this).hide()})});var h;e(i).on("resize",function(){g.removeScene([reinigungLageplan,reinigungMechanisch,reinigungBiologisch,u]),clearTimeout(h),h=setTimeout(function(){console.log("log delay"),g.addScene([reinigungLageplan,reinigungMechanisch,reinigungBiologisch,u]),e(".progressbar, .scrollmagic-pin-spacer").css({height:e(i).height()+2}),u.duration(e(".progress-wrapper").outerHeight()-e(i).height()),a.hasClass("open")&&t.removeClass("open"),e(".sec-intro").css("min-height",3*e(i).height()-e(".header").outerHeight())},250)}),e(".nav-sidebar a").anchorScroll({scrollSpeed:800,offsetTop:e(".header").height()})})}(jQuery,window,document);