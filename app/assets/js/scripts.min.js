/*!
 * potsdam-wasser
 * 
 * 
 * @author Dustin Kummer
 * @version 1.0.0
 * Copyright 2016. MIT licensed.
 */
!function(e,i,r,n){"use strict";function s(i,r,s,o){return new ScrollMagic.Scene({triggerElement:i,triggerHook:1,duration:e(i).outerHeight()}).addIndicators({name:i}).on("progress",function(i){e(r).css("height",100/3*i.progress.toFixed(3)+"%"),o===n&&(o=s);var t=[o[0]-s[0],o[1]-s[1],o[2]-s[2]],a=[Math.round(s[0]+t[0]*i.progress.toFixed(3)),Math.round(s[1]+t[1]*i.progress.toFixed(3)),Math.round(s[2]+t[2]*i.progress.toFixed(3))];e(".indicator").css("background-color","rgb("+a.join(",")+")")})}function o(r,s,o,t){return null!==s&&s!==n||(s=1/e(i).height()*e(".header").outerHeight()),null!==o&&o!==n||(o=e(r).outerHeight()-e(e(r).attr("data-set-pin")).outerHeight()-20),t=null!==t&&t!==n,console.log(e(e(r).attr("data-set-pin")).outerHeight()),new ScrollMagic.Scene({triggerElement:r,triggerHook:s,duration:o,pushFollowers:t,reverse:!0}).addIndicators({name:r}).setPin(e(r).attr("data-set-pin"))}var t=e(".logo-pw"),a=e(".logo-pw, .sidebar"),g=e(".sidebar");e(i).on("scroll",function(){var r=e(i).scrollTop();e(".header").toggleClass("shrink",r>200),g.toggleClass("shrink",r>200)}),t.on("click",function(e){e.preventDefault(),g.hasClass("open")?a.removeClass("open"):a.addClass("open")}),e("main, footer").on("click",function(){g.hasClass("open")&&a.removeClass("open")});var l=new ScrollMagic.Controller;e(".progressbar").css({height:e(i).height()}).append('<div class="indicator indicator-gewinnung"></div><div class="indicator indicator-versorgung"></div><div class="indicator indicator-reinigung"></div>');var c=s(".sec-gewinnung",".indicator-gewinnung",[114,120,141]),d=s(".sec-versorgung",".indicator-versorgung",[114,120,141],[56,115,185]),u=s(".sec-reinigung",".indicator-reinigung",[56,115,185],[134,120,109]),h=new ScrollMagic.Scene({triggerElement:".progress-wrapper",triggerHook:0,duration:e(".progress-wrapper").outerHeight()-e(i).height(),reverse:!0}).addIndicators({name:"Progressbar"}).setPin(".progressbar");e("section").each(function(i,r){var n=e(this).outerHeight();new ScrollMagic.Scene({triggerElement:r,duration:n}).on("enter",function(){0===i&&e(".side-intro").addClass("active").siblings("li").removeClass("active").children("ul").slideUp(),1===i?e(".side-gewinnung > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp():2===i?e(".side-versorgung > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp():3===i&&e(".side-reinigung > ul").slideDown().parent("li").addClass("active").siblings("li").removeClass("active").children("ul").slideUp()}).addTo(l)});var p=o("#trigger-reinigung-lageplan"),v=o("#trigger-reinigung-mechanische-reinigung"),m=o("#trigger-reinigung-biologische-reinigung");l.addScene([c,d,u,h,p,v,m]),e(".sec-intro").css("min-height",3*e(i).height()-e(".header").outerHeight()).children().children().children(".content").css({position:"absolute",top:100/3+"%",left:0}),e(i).on("resize",function(){e(".progressbar, .scrollmagic-pin-spacer").css({height:e(i).height()}),h.duration(e(".progress-wrapper").outerHeight()-e(i).height()),g.hasClass("open")&&a.removeClass("open"),e(".sec-intro").css("min-height",3*e(i).height()-e(".header").outerHeight())}),e(".nav-sidebar a").anchorScroll({scrollSpeed:800,offsetTop:e(".header").height()})}(jQuery,window,document);